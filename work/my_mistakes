# 工作中的错题集
2015-07-01
1 现象：①系统运行一段时间后卡死
        ②后台报错内容是不能获取到hibernate的session
	③查看数据库的连接总有一些连接状态为sleep，时间持续走高不会下降
	④走查所有service和dao层的代码发现session都是spring管理的会自动关闭
  原因：在action中跨过service直接调用了dao，又采用的是声明式事务管理，导致session脱离了spring的管理，使得这种方法使用过的session不能正常关闭。
  	当这个方法调用次数到session极限时就出现上面的现象。

2015-09-17
2 现象：页面提交表单时报404错误，但是对应的action和方法都正确
  原因：表单里面有两个同名参数

2015-09-20
3 现象：页面修改了数据，也正确提交到数据库了，但是点击编辑按钮后总有些数据是修改前的值。
  原因：使用<s:textfield >标签时，value属性给了一个常量数据值。

2016-10-14
4 场景：会员退款出账后修改会员的级别为【普通会员】并将用户余额扣减
  现象：同一个service先修改会员级别，然后操作财务扣款，导致最后会员余额未减少。
  原因：①从数据库中读取会员数据member
       ②调用主站本地service修改member的级别(此时事务还未提交)
       ③调用财务系统接口扣减用户余额（财务系统和主站系统使用同一数据库）
       ④执行完成提交（程序完成后②中未提交的事务会提交到数据库）
       第四步将第二步中的数据覆盖，导致问题产生
  解决方案：将执行顺序修改为③①②④，也就是主站系统修改会员数据前先从数据库获取最新的会员数据。
